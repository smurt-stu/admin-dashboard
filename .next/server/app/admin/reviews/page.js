(()=>{var e={};e.id=160,e.ids=[160],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},25146:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>c});var r=t(70260),a=t(28203),l=t(25155),i=t.n(l),n=t(67292),d={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let c=["",{children:["admin",{children:["reviews",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,82134)),"/home/mohjas/CascadeProjects/admin/app/admin/reviews/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,54899)),"/home/mohjas/CascadeProjects/admin/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,19611)),"/home/mohjas/CascadeProjects/admin/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,61129)),"/home/mohjas/CascadeProjects/admin/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}],o=["/home/mohjas/CascadeProjects/admin/app/admin/reviews/page.tsx"],x={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/admin/reviews/page",pathname:"/admin/reviews",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},46561:(e,s,t)=>{Promise.resolve().then(t.bind(t,82134))},59713:(e,s,t)=>{Promise.resolve().then(t.bind(t,70591))},70591:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=t(45512),a=t(58009),l=t(28531),i=t.n(l);function n({isOpen:e,onClose:s,reviewId:t,reviewTitle:l,onReplySubmitted:i}){let[n,d]=(0,a.useState)(""),[c,o]=(0,a.useState)(!1),x=async e=>{if(e.preventDefault(),n.trim()){o(!0);try{(await fetch(`/api/admin/reviews/${t}/merchant_reply/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({merchant_reply:n.trim()})})).ok&&(d(""),i(),s())}catch(e){}finally{o(!1)}}};return e?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"إضافة رد التاجر"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)("i",{className:"ri-close-line text-xl"})})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"المراجعة:"}),(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900 bg-gray-50 p-3 rounded-lg",children:['"',l,'"']})]}),(0,r.jsxs)("form",{onSubmit:x,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"replyText",className:"block text-sm font-medium text-gray-700 mb-2",children:"رد التاجر"}),(0,r.jsx)("textarea",{id:"replyText",value:n,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:4,placeholder:"اكتب رد التاجر هنا...",required:!0})]}),(0,r.jsxs)("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[(0,r.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"إلغاء"}),(0,r.jsx)("button",{type:"submit",disabled:c||!n.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white ml-2"}),"جاري الإرسال..."]}):"إرسال الرد"})]})]})]})})}):null}function d(){let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)({total_reviews:0,pending_reviews:0,approved_reviews:0,average_rating:0,total_comments:0,pending_comments:0}),[d,c]=(0,a.useState)(!0),[o,x]=(0,a.useState)("all"),[m,p]=(0,a.useState)({isOpen:!1,reviewId:0,reviewTitle:""}),h=async()=>{try{let e=new URLSearchParams;"all"!==o&&e.append("is_approved","approved"===o?"true":"false");let t=await fetch(`/api/admin/reviews/?${e.toString()}`),r=await t.json();r.success&&s(r.data.results||[])}catch(e){}},g=async()=>{try{let e=await fetch("/api/admin/statistics/overview/"),s=await e.json();s.success&&l(s.data)}catch(e){}finally{c(!1)}},u=async e=>{try{(await fetch(`/api/admin/reviews/${e}/approve/`,{method:"PUT",headers:{"Content-Type":"application/json"}})).ok&&(h(),g())}catch(e){}},j=async e=>{try{(await fetch(`/api/admin/reviews/${e}/reject/`,{method:"PUT",headers:{"Content-Type":"application/json"}})).ok&&(h(),g())}catch(e){}},b=(e,s)=>{p({isOpen:!0,reviewId:e,reviewTitle:s})},v=e=>Array.from({length:5},(s,t)=>(0,r.jsx)("i",{className:`ri-star-${t<e?"fill":"line"} text-yellow-400`},t)),y=e=>null===e?(0,r.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs",children:"في الانتظار"}):e?(0,r.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:"معتمد"}):(0,r.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs",children:"مرفوض"});return d?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"إدارة المراجعات"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"إدارة مراجعات المنتجات والخدمات"})]}),(0,r.jsxs)("div",{className:"mt-4 sm:mt-0 flex space-x-2 rtl:space-x-reverse",children:[(0,r.jsxs)(i(),{href:"/admin/reviews/comments",className:"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[(0,r.jsx)("i",{className:"ri-chat-1-fill ml-2"}),"إدارة التعليقات"]}),(0,r.jsxs)(i(),{href:"/admin/reviews/statistics",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)("i",{className:"ri-bar-chart-fill ml-2"}),"إحصائيات مفصلة"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,r.jsx)("i",{className:"ri-star-fill text-blue-600 text-xl"})}),(0,r.jsxs)("div",{className:"mr-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"إجمالي المراجعات"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t.total_reviews})]})]})}),(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,r.jsx)("i",{className:"ri-time-fill text-yellow-600 text-xl"})}),(0,r.jsxs)("div",{className:"mr-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"في الانتظار"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t.pending_reviews})]})]})}),(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,r.jsx)("i",{className:"ri-check-fill text-green-600 text-xl"})}),(0,r.jsxs)("div",{className:"mr-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"متوسط التقييم"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t.average_rating.toFixed(1)})]})]})}),(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,r.jsx)("i",{className:"ri-chat-1-fill text-purple-600 text-xl"})}),(0,r.jsxs)("div",{className:"mr-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"التعليقات"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t.total_comments})]})]})})]}),(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsx)("button",{onClick:()=>x("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"all"===o?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"جميع المراجعات"}),(0,r.jsx)("button",{onClick:()=>x("pending"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"pending"===o?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"في الانتظار"}),(0,r.jsx)("button",{onClick:()=>x("approved"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"approved"===o?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"معتمدة"}),(0,r.jsx)("button",{onClick:()=>x("rejected"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"rejected"===o?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"مرفوضة"})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"المراجعات"})}),(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:0===e.length?(0,r.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,r.jsx)("i",{className:"ri-inbox-line text-4xl mb-4"}),(0,r.jsx)("p",{children:"لا توجد مراجعات"})]}):e.map(e=>(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 rtl:space-x-reverse mb-3",children:[(0,r.jsx)("img",{src:e.user_avatar||"/default-avatar.png",alt:e.user_name,className:"w-10 h-10 rounded-full"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900",children:e.user_name}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:e.product_title})]}),e.is_verified_purchase&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:[(0,r.jsx)("i",{className:"ri-check-line ml-1"}),"مشتري موثق"]})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 rtl:space-x-reverse mb-2",children:[(0,r.jsx)("div",{className:"flex",children:v(e.rating)}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.rating,"/5)"]}),y(e.is_approved)]}),(0,r.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:e.title}),(0,r.jsx)("p",{className:"text-gray-700 text-sm leading-relaxed",children:e.review_text})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"الجودة"}),(0,r.jsx)("div",{className:"flex justify-center",children:v(e.quality_rating)})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"القيمة"}),(0,r.jsx)("div",{className:"flex justify-center",children:v(e.value_rating)})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"سهولة الاستخدام"}),(0,r.jsx)("div",{className:"flex justify-center",children:v(e.ease_of_use_rating)})]})]}),e.merchant_reply&&(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg mb-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"رد التاجر:"}),(0,r.jsx)("p",{className:"text-sm text-blue-800",children:e.merchant_reply})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,r.jsxs)("span",{children:["مفيدة: ",e.helpfulness_score]}),(0,r.jsx)("span",{children:new Date(e.created_at).toLocaleDateString("ar-SA")})]})]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2 mr-4",children:[null===e.is_approved&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>u(e.id),className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors",children:[(0,r.jsx)("i",{className:"ri-check-line ml-1"}),"اعتماد"]}),(0,r.jsxs)("button",{onClick:()=>j(e.id),className:"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700 transition-colors",children:[(0,r.jsx)("i",{className:"ri-close-line ml-1"}),"رفض"]})]}),(0,r.jsxs)("button",{onClick:()=>b(e.id,e.title),className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors",children:[(0,r.jsx)("i",{className:"ri-reply-line ml-1"}),"رد التاجر"]})]})]})},e.id))})]}),(0,r.jsx)(n,{isOpen:m.isOpen,onClose:()=>p({isOpen:!1,reviewId:0,reviewTitle:""}),reviewId:m.reviewId,reviewTitle:m.reviewTitle,onReplySubmitted:()=>{h(),g()}})]})}},82134:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/mohjas/CascadeProjects/admin/app/admin/reviews/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/mohjas/CascadeProjects/admin/app/admin/reviews/page.tsx","default")}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[135,889,817],()=>t(25146));module.exports=r})();