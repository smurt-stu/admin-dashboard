(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[356],{70389:(e,t,a)=>{Promise.resolve().then(a.bind(a,54750))},54750:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(95155),r=a(12115),c=a(76046),o=a(10547);function d(){let e=(0,c.useRouter)(),[t,a]=(0,r.useState)({formData:{title:"",description:"",price:0,sku:"",category:void 0,is_active:!0,is_featured:!1,is_new_arrival:!1,is_on_sale:!1,discount_percentage:0,stock_quantity:0,reorder_point:10,meta_title:"",meta_description:"",meta_keywords:""},categories:[],constants:null,loading:!0,saving:!1,error:null,images:[],imagePreview:[]}),d=e=>{a(t=>({...t,...e}))},n=e=>{a(t=>({...t,formData:{...t.formData,...e}}))};(0,r.useEffect)(()=>{i()},[]);let i=async()=>{try{let[e,t]=await Promise.all([o.j.getCategories({is_active:!0}),o.j.getStoreConstants()]);d({categories:e.results,constants:t,loading:!1})}catch(e){console.error("Error loading initial data:",e),d({error:"فشل في تحميل البيانات الأولية",loading:!1})}},l=e=>{let a=t.images.filter((t,a)=>a!==e),s=t.imagePreview.filter((t,a)=>a!==e);URL.revokeObjectURL(t.imagePreview[e]),d({images:a,imagePreview:s})},u=async a=>{if(a.preventDefault(),!t.formData.title||!t.formData.sku||!t.formData.category){d({error:"يرجى ملء جميع الحقول المطلوبة"});return}try{d({saving:!0,error:null});let a=await o.j.createProduct(t.formData);if(t.images.length>0)for(let e=0;e<t.images.length;e++){let s=new FormData;s.append("product",a.id.toString()),s.append("image",t.images[e]),s.append("is_main",0===e?"true":"false"),s.append("order",e.toString()),await o.j.uploadProductImage(s)}e.push("/admin/products")}catch(e){console.error("Error creating product:",e),d({error:e instanceof Error?e.message:"فشل في إنشاء المنتج",saving:!1})}};return t.loading?(0,s.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"جاري تحميل البيانات..."})]})}):(0,s.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"إضافة منتج جديد"}),(0,s.jsx)("p",{className:"text-gray-600",children:"أضف منتجاً جديداً إلى متجرك"})]}),(0,s.jsxs)("button",{onClick:()=>e.back(),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[(0,s.jsx)("i",{className:"ri-arrow-right-line"}),"رجوع"]})]}),t.error&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg",children:t.error}),(0,s.jsxs)("form",{onSubmit:u,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"المعلومات الأساسية"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["اسم المنتج ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"text",value:t.formData.title,onChange:e=>n({title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"أدخل اسم المنتج",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["SKU ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:t.formData.sku,onChange:e=>n({sku:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"مثال: PRD-123456",required:!0}),(0,s.jsx)("button",{type:"button",onClick:()=>{n({sku:"PRD-".concat(Date.now().toString().slice(-6))})},className:"bg-gray-100 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-200",children:"توليد"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["التصنيف ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)("select",{value:t.formData.category||"",onChange:e=>n({category:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[(0,s.jsx)("option",{value:"",children:"اختر التصنيف"}),t.categories.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["السعر (ريال) ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"number",step:"0.01",min:"0",value:t.formData.price,onChange:e=>n({price:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نسبة الخصم (%)"}),(0,s.jsx)("input",{type:"number",min:"0",max:"100",value:t.formData.discount_percentage,onChange:e=>n({discount_percentage:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المنتج"}),(0,s.jsx)("textarea",{value:t.formData.description,onChange:e=>n({description:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"اكتب وصفاً مفصلاً للمنتج"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"إدارة المخزون"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كمية المخزون"}),(0,s.jsx)("input",{type:"number",min:"0",value:t.formData.stock_quantity,onChange:e=>n({stock_quantity:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نقطة إعادة الطلب"}),(0,s.jsx)("input",{type:"number",min:"0",value:t.formData.reorder_point,onChange:e=>n({reorder_point:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"10"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"سيتم تنبيهك عندما يصل المخزون إلى هذا الرقم"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"صور المنتج"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رفع الصور"}),(0,s.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>{let a=Array.from(e.target.files||[]),s=[...t.images,...a],r=[...t.imagePreview];a.forEach(e=>{r.push(URL.createObjectURL(e))}),d({images:s,imagePreview:r})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"يمكنك رفع عدة صور. الصورة الأولى ستكون الصورة الرئيسية"})]}),t.imagePreview.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.imagePreview.map((e,t)=>(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:e,alt:"Preview ".concat(t+1),className:"w-full h-24 object-cover rounded-lg border"}),(0,s.jsx)("button",{type:"button",onClick:()=>l(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600",children:"\xd7"}),0===t&&(0,s.jsx)("span",{className:"absolute bottom-1 left-1 bg-blue-500 text-white text-xs px-2 py-1 rounded",children:"رئيسية"})]},t))})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"حالة المنتج"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"is_active",checked:t.formData.is_active,onChange:e=>n({is_active:e.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsx)("label",{htmlFor:"is_active",className:"mr-2 text-sm text-gray-700",children:"منتج نشط (سيظهر في المتجر)"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"is_featured",checked:t.formData.is_featured,onChange:e=>n({is_featured:e.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsx)("label",{htmlFor:"is_featured",className:"mr-2 text-sm text-gray-700",children:"منتج مميز"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"is_new_arrival",checked:t.formData.is_new_arrival,onChange:e=>n({is_new_arrival:e.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsx)("label",{htmlFor:"is_new_arrival",className:"mr-2 text-sm text-gray-700",children:"وصل حديثاً"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"is_on_sale",checked:t.formData.is_on_sale,onChange:e=>n({is_on_sale:e.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsx)("label",{htmlFor:"is_on_sale",className:"mr-2 text-sm text-gray-700",children:"في التخفيضات"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"تحسين محركات البحث (SEO)"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الصفحة (Meta Title)"}),(0,s.jsx)("input",{type:"text",value:t.formData.meta_title,onChange:e=>n({meta_title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"عنوان محسن لمحركات البحث"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الصفحة (Meta Description)"}),(0,s.jsx)("textarea",{value:t.formData.meta_description,onChange:e=>n({meta_description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"وصف مختصر للمنتج يظهر في نتائج البحث"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية (Meta Keywords)"}),(0,s.jsx)("input",{type:"text",value:t.formData.meta_keywords,onChange:e=>n({meta_keywords:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"كلمة1، كلمة2، كلمة3"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>e.back(),className:"bg-gray-100 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-200",disabled:t.saving,children:"إلغاء"}),(0,s.jsx)("button",{type:"submit",disabled:t.saving,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:t.saving?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("i",{className:"ri-save-line"}),"حفظ المنتج"]})})]})]})]})}},10547:(e,t,a)=>{"use strict";a.d(t,{j:()=>c});let s="https://smart-ai-api.onrender.com/api/v1";class r{async getAuthHeaders(){let e=localStorage.getItem("access_token");return{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}}async handleResponse(e){if(!e.ok){let t=await e.text();throw Error("HTTP ".concat(e.status,": ").concat(t))}return e.json()}async getStoreConstants(){let e=await fetch("".concat(s,"/store/core/constants/"));return this.handleResponse(e)}async getCategories(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[a,s]=e;void 0!==s&&t.append(a,s.toString())});let a=await fetch("".concat(s,"/store/products/categories/?").concat(t),{headers:await this.getAuthHeaders()});return this.handleResponse(a)}async getCategoryTree(){let e=await fetch("".concat(s,"/store/products/categories/tree/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getCategory(e){let t=await fetch("".concat(s,"/store/products/categories/").concat(e,"/"),{headers:await this.getAuthHeaders()});return this.handleResponse(t)}async createCategory(e){let t=await fetch("".concat(s,"/store/products/categories/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateCategory(e,t){let a=await fetch("".concat(s,"/store/products/categories/").concat(e,"/"),{method:"PATCH",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async deleteCategory(e){let t=await fetch("".concat(s,"/store/products/categories/").concat(e,"/"),{method:"DELETE",headers:await this.getAuthHeaders()});if(!t.ok)throw Error("Failed to delete category: ".concat(t.statusText))}async getCategoryProducts(e,t){let a=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,s]=e;void 0!==s&&a.append(t,s.toString())});let r=await fetch("".concat(s,"/store/products/categories/").concat(e,"/products/?").concat(a),{headers:await this.getAuthHeaders()});return this.handleResponse(r)}async getProducts(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[a,s]=e;void 0!==s&&t.append(a,s.toString())});let a=await fetch("".concat(s,"/store/products/products/?").concat(t),{headers:await this.getAuthHeaders()});return this.handleResponse(a)}async getProduct(e){let t=await fetch("".concat(s,"/store/products/products/").concat(e,"/"),{headers:await this.getAuthHeaders()});return this.handleResponse(t)}async createProduct(e){let t=await fetch("".concat(s,"/store/products/products/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateProduct(e,t){let a=await fetch("".concat(s,"/store/products/products/").concat(e,"/"),{method:"PATCH",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async deleteProduct(e){let t=await fetch("".concat(s,"/store/products/products/").concat(e,"/"),{method:"DELETE",headers:await this.getAuthHeaders()});if(!t.ok)throw Error("Failed to delete product: ".concat(t.statusText))}async bulkUpdateProducts(e){let t=await fetch("".concat(s,"/store/products/products/bulk-update/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify({products:e})});return this.handleResponse(t)}async updateProductStock(e,t){let a=await fetch("".concat(s,"/store/products/products/").concat(e,"/update-stock/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async getFeaturedProducts(){let e=await fetch("".concat(s,"/store/products/products/featured/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getBestSellers(){let e=await fetch("".concat(s,"/store/products/products/bestsellers/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getNewArrivals(){let e=await fetch("".concat(s,"/store/products/products/new_arrivals/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getOnSaleProducts(){let e=await fetch("".concat(s,"/store/products/products/on_sale/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async searchProducts(e,t){let a=new URLSearchParams({q:e});t&&Object.entries(t).forEach(e=>{let[t,s]=e;void 0!==s&&a.append(t,s.toString())});let r=await fetch("".concat(s,"/store/products/products/search/?").concat(a),{headers:await this.getAuthHeaders()});return this.handleResponse(r)}async getRelatedProducts(e){let t=await fetch("".concat(s,"/store/products/products/").concat(e,"/related/"),{headers:await this.getAuthHeaders()});return this.handleResponse(t)}async getProductImages(e){let t=new URLSearchParams;e&&t.append("product",e.toString());let a=await fetch("".concat(s,"/store/products/images/?").concat(t),{headers:await this.getAuthHeaders()});return this.handleResponse(a)}async uploadProductImage(e){let t=localStorage.getItem("access_token"),a=await fetch("".concat(s,"/store/products/images/"),{method:"POST",headers:{...t&&{Authorization:"Bearer ".concat(t)}},body:e});return this.handleResponse(a)}async updateProductImage(e,t){let a=await fetch("".concat(s,"/store/products/images/").concat(e,"/"),{method:"PATCH",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async deleteProductImage(e){let t=await fetch("".concat(s,"/store/products/images/").concat(e,"/"),{method:"DELETE",headers:await this.getAuthHeaders()});if(!t.ok)throw Error("Failed to delete image: ".concat(t.statusText))}async setMainProductImage(e){let t=await fetch("".concat(s,"/store/products/images/").concat(e,"/set_main/"),{method:"POST",headers:await this.getAuthHeaders()});return this.handleResponse(t)}async reorderProductImages(e){let t=await fetch("".concat(s,"/store/products/images/reorder/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify({orders:e})});return this.handleResponse(t)}async getAnalytics(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[a,s]=e;void 0!==s&&t.append(a,s.toString())});let a=await fetch("".concat(s,"/store/products/analytics/?").concat(t),{headers:await this.getAuthHeaders()});return this.handleResponse(a)}async getDashboardAnalytics(){let e=await fetch("".concat(s,"/store/products/analytics/dashboard/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getInventoryReport(){let e=await fetch("".concat(s,"/store/products/analytics/inventory-report/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getCategoryAnalytics(e){let t=await fetch("".concat(s,"/store/products/categories/").concat(e,"/analytics/"),{headers:await this.getAuthHeaders()});return this.handleResponse(t)}}let c=new r},76046:(e,t,a)=>{"use strict";var s=a(66658);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(70389)),_N_E=e.O()}]);