(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[631],{45120:(e,t,a)=>{Promise.resolve().then(a.bind(a,27957))},27957:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var r=a(95155),s=a(12115),o=a(10547);function c(){let[e,t]=(0,s.useState)({categories:[],categoryTree:[],loading:!0,error:null,showCreateModal:!1,showEditModal:!1,editingCategory:null,formData:{name:"",description:"",parent:void 0,is_active:!0,meta_keywords:""},searchTerm:""}),a=e=>{t(t=>({...t,...e}))},c=()=>{a({formData:{name:"",description:"",parent:void 0,is_active:!0,meta_keywords:""}})};(0,s.useEffect)(()=>{n(),i()},[]);let n=async()=>{try{a({loading:!0,error:null});let t=await o.j.getCategories({search:e.searchTerm||void 0});a({categories:t.results,loading:!1})}catch(e){console.error("Error loading categories:",e),a({error:"فشل في تحميل الفئات",loading:!1})}},i=async()=>{try{let e=await o.j.getCategoryTree();a({categoryTree:e})}catch(e){console.error("Error loading category tree:",e)}};(0,s.useEffect)(()=>{let e=setTimeout(()=>{n()},500);return()=>clearTimeout(e)},[e.searchTerm]);let d=async t=>{if(t.preventDefault(),!e.formData.name.trim()){a({error:"اسم الفئة مطلوب"});return}try{let t={...e.formData,parent:e.formData.parent||void 0};await o.j.createCategory(t),await n(),await i(),a({showCreateModal:!1}),c()}catch(e){console.error("Error creating category:",e),a({error:"فشل في إنشاء الفئة"})}},l=async t=>{if(t.preventDefault(),!e.editingCategory||!e.formData.name.trim()){a({error:"اسم الفئة مطلوب"});return}try{let t={...e.formData,parent:e.formData.parent||void 0};await o.j.updateCategory(e.editingCategory.id,t),await n(),await i(),a({showEditModal:!1,editingCategory:null}),c()}catch(e){console.error("Error updating category:",e),a({error:"فشل في تحديث الفئة"})}},h=async e=>{if(confirm("هل أنت متأكد من حذف هذه الفئة؟ سيتم حذف جميع الفئات الفرعية أيضاً."))try{await o.j.deleteCategory(e),await n(),await i()}catch(e){console.error("Error deleting category:",e),a({error:"فشل في حذف الفئة"})}},u=e=>{a({editingCategory:e,showEditModal:!0,formData:{name:e.name,description:e.description||"",parent:e.parent,is_active:e.is_active,meta_keywords:e.meta_keywords||""}})},g=()=>{c(),a({showCreateModal:!0})},m=()=>{a({showCreateModal:!1,showEditModal:!1,editingCategory:null}),c()};return e.loading&&0===e.categories.length?(0,r.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"جاري تحميل الفئات..."})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"إدارة الفئات"}),(0,r.jsx)("p",{className:"text-gray-600",children:"إدارة ومتابعة فئات المنتجات"})]}),(0,r.jsxs)("button",{onClick:g,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-add-line"}),"إضافة فئة جديدة"]})]}),e.error&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg",children:e.error}),(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"text",value:e.searchTerm,onChange:e=>a({searchTerm:e.target.value}),placeholder:"البحث في الفئات...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})}),(0,r.jsx)("button",{onClick:n,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200",children:(0,r.jsx)("i",{className:"ri-refresh-line"})})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"قائمة الفئات"}),0===e.categories.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("i",{className:"ri-folder-line text-4xl text-gray-400 mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد فئات"}),(0,r.jsx)("p",{className:"text-gray-500 mb-6",children:"ابدأ بإضافة فئات لتنظيم منتجاتك"}),(0,r.jsxs)("button",{onClick:g,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 inline-flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-add-line"}),"إضافة فئة جديدة"]})]}):(0,r.jsx)("div",{className:"space-y-3",children:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map(e=>(0,r.jsx)("div",{className:"border rounded-lg p-4 mb-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{style:{marginRight:"".concat(20*t,"px")},children:t>0&&(0,r.jsx)("span",{className:"text-gray-400",children:"└─"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"نشط":"غير نشط"}),void 0!==e.products_count&&(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[e.products_count," منتج"]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>u(e),className:"text-blue-600 hover:text-blue-900 p-1",children:(0,r.jsx)("i",{className:"ri-edit-line"})}),(0,r.jsx)("button",{onClick:()=>h(e.id),className:"text-red-600 hover:text-red-900 p-1",children:(0,r.jsx)("i",{className:"ri-delete-bin-line"})})]})]})},e.id))}(e.categoryTree)})]}),e.showCreateModal&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"إضافة فئة جديدة"}),(0,r.jsx)("button",{onClick:m,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("i",{className:"ri-close-line text-xl"})})]}),(0,r.jsxs)("form",{onSubmit:d,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["اسم الفئة ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:e.formData.name,onChange:t=>a({formData:{...e.formData,name:t.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"أدخل اسم الفئة",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الفئة الأساسية"}),(0,r.jsxs)("select",{value:e.formData.parent||"",onChange:t=>a({formData:{...e.formData,parent:t.target.value?Number(t.target.value):void 0}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"فئة رئيسية"}),e.categories.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الوصف"}),(0,r.jsx)("textarea",{value:e.formData.description,onChange:t=>a({formData:{...e.formData,description:t.target.value}}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"وصف مختصر للفئة"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),(0,r.jsx)("input",{type:"text",value:e.formData.meta_keywords,onChange:t=>a({formData:{...e.formData,meta_keywords:t.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"كلمة1، كلمة2، كلمة3"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"is_active_create",checked:e.formData.is_active,onChange:t=>a({formData:{...e.formData,is_active:t.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,r.jsx)("label",{htmlFor:"is_active_create",className:"mr-2 text-sm text-gray-700",children:"فئة نشطة"})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:m,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200",children:"إلغاء"}),(0,r.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"حفظ"})]})]})]})}),e.showEditModal&&e.editingCategory&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"تعديل الفئة"}),(0,r.jsx)("button",{onClick:m,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("i",{className:"ri-close-line text-xl"})})]}),(0,r.jsxs)("form",{onSubmit:l,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["اسم الفئة ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:e.formData.name,onChange:t=>a({formData:{...e.formData,name:t.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"أدخل اسم الفئة",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الفئة الأساسية"}),(0,r.jsxs)("select",{value:e.formData.parent||"",onChange:t=>a({formData:{...e.formData,parent:t.target.value?Number(t.target.value):void 0}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"فئة رئيسية"}),e.categories.filter(t=>{var a;return t.id!==(null===(a=e.editingCategory)||void 0===a?void 0:a.id)}).map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الوصف"}),(0,r.jsx)("textarea",{value:e.formData.description,onChange:t=>a({formData:{...e.formData,description:t.target.value}}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"وصف مختصر للفئة"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),(0,r.jsx)("input",{type:"text",value:e.formData.meta_keywords,onChange:t=>a({formData:{...e.formData,meta_keywords:t.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"كلمة1، كلمة2، كلمة3"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"is_active_edit",checked:e.formData.is_active,onChange:t=>a({formData:{...e.formData,is_active:t.target.checked}}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,r.jsx)("label",{htmlFor:"is_active_edit",className:"mr-2 text-sm text-gray-700",children:"فئة نشطة"})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:m,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200",children:"إلغاء"}),(0,r.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"حفظ التغييرات"})]})]})]})})]})}},10547:(e,t,a)=>{"use strict";a.d(t,{j:()=>o});let r="https://smart-ai-api.onrender.com/api/v1";class s{async getAuthHeaders(){let e=localStorage.getItem("access_token");return{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}}async handleResponse(e){if(!e.ok){let t=await e.text();throw Error("HTTP ".concat(e.status,": ").concat(t))}return e.json()}async getStoreConstants(){let e=await fetch("".concat(r,"/store/core/constants/"));return this.handleResponse(e)}async getCategories(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[a,r]=e;void 0!==r&&t.append(a,r.toString())});let a=await fetch("".concat(r,"/store/products/categories/?").concat(t),{headers:await this.getAuthHeaders()});return this.handleResponse(a)}async getCategoryTree(){let e=await fetch("".concat(r,"/store/products/categories/tree/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getCategory(e){let t=await fetch("".concat(r,"/store/products/categories/").concat(e,"/"),{headers:await this.getAuthHeaders()});return this.handleResponse(t)}async createCategory(e){let t=await fetch("".concat(r,"/store/products/categories/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateCategory(e,t){let a=await fetch("".concat(r,"/store/products/categories/").concat(e,"/"),{method:"PATCH",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async deleteCategory(e){let t=await fetch("".concat(r,"/store/products/categories/").concat(e,"/"),{method:"DELETE",headers:await this.getAuthHeaders()});if(!t.ok)throw Error("Failed to delete category: ".concat(t.statusText))}async getCategoryProducts(e,t){let a=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,r]=e;void 0!==r&&a.append(t,r.toString())});let s=await fetch("".concat(r,"/store/products/categories/").concat(e,"/products/?").concat(a),{headers:await this.getAuthHeaders()});return this.handleResponse(s)}async getProducts(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[a,r]=e;void 0!==r&&t.append(a,r.toString())});let a=await fetch("".concat(r,"/store/products/products/?").concat(t),{headers:await this.getAuthHeaders()});return this.handleResponse(a)}async getProduct(e){let t=await fetch("".concat(r,"/store/products/products/").concat(e,"/"),{headers:await this.getAuthHeaders()});return this.handleResponse(t)}async createProduct(e){let t=await fetch("".concat(r,"/store/products/products/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateProduct(e,t){let a=await fetch("".concat(r,"/store/products/products/").concat(e,"/"),{method:"PATCH",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async deleteProduct(e){let t=await fetch("".concat(r,"/store/products/products/").concat(e,"/"),{method:"DELETE",headers:await this.getAuthHeaders()});if(!t.ok)throw Error("Failed to delete product: ".concat(t.statusText))}async bulkUpdateProducts(e){let t=await fetch("".concat(r,"/store/products/products/bulk-update/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify({products:e})});return this.handleResponse(t)}async updateProductStock(e,t){let a=await fetch("".concat(r,"/store/products/products/").concat(e,"/update-stock/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async getFeaturedProducts(){let e=await fetch("".concat(r,"/store/products/products/featured/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getBestSellers(){let e=await fetch("".concat(r,"/store/products/products/bestsellers/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getNewArrivals(){let e=await fetch("".concat(r,"/store/products/products/new_arrivals/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getOnSaleProducts(){let e=await fetch("".concat(r,"/store/products/products/on_sale/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async searchProducts(e,t){let a=new URLSearchParams({q:e});t&&Object.entries(t).forEach(e=>{let[t,r]=e;void 0!==r&&a.append(t,r.toString())});let s=await fetch("".concat(r,"/store/products/products/search/?").concat(a),{headers:await this.getAuthHeaders()});return this.handleResponse(s)}async getRelatedProducts(e){let t=await fetch("".concat(r,"/store/products/products/").concat(e,"/related/"),{headers:await this.getAuthHeaders()});return this.handleResponse(t)}async getProductImages(e){let t=new URLSearchParams;e&&t.append("product",e.toString());let a=await fetch("".concat(r,"/store/products/images/?").concat(t),{headers:await this.getAuthHeaders()});return this.handleResponse(a)}async uploadProductImage(e){let t=localStorage.getItem("access_token"),a=await fetch("".concat(r,"/store/products/images/"),{method:"POST",headers:{...t&&{Authorization:"Bearer ".concat(t)}},body:e});return this.handleResponse(a)}async updateProductImage(e,t){let a=await fetch("".concat(r,"/store/products/images/").concat(e,"/"),{method:"PATCH",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async deleteProductImage(e){let t=await fetch("".concat(r,"/store/products/images/").concat(e,"/"),{method:"DELETE",headers:await this.getAuthHeaders()});if(!t.ok)throw Error("Failed to delete image: ".concat(t.statusText))}async setMainProductImage(e){let t=await fetch("".concat(r,"/store/products/images/").concat(e,"/set_main/"),{method:"POST",headers:await this.getAuthHeaders()});return this.handleResponse(t)}async reorderProductImages(e){let t=await fetch("".concat(r,"/store/products/images/reorder/"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify({orders:e})});return this.handleResponse(t)}async getAnalytics(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[a,r]=e;void 0!==r&&t.append(a,r.toString())});let a=await fetch("".concat(r,"/store/products/analytics/?").concat(t),{headers:await this.getAuthHeaders()});return this.handleResponse(a)}async getDashboardAnalytics(){let e=await fetch("".concat(r,"/store/products/analytics/dashboard/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getInventoryReport(){let e=await fetch("".concat(r,"/store/products/analytics/inventory-report/"),{headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getCategoryAnalytics(e){let t=await fetch("".concat(r,"/store/products/categories/").concat(e,"/analytics/"),{headers:await this.getAuthHeaders()});return this.handleResponse(t)}}let o=new s}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(45120)),_N_E=e.O()}]);